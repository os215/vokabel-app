<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Vokabel Trainer 0.1a</title>
  <meta name="theme-color" content="#4F46E5" />
  <link rel="stylesheet" href="styles.css" />
  <link rel="manifest" href="/manifest.json">
  <link rel="icon" href="/icon-192.png">
</head>
<body>
  <main class="container">
    <h1>Vokabel Trainer 0.1b</h1>

    <div class="tabs">
      <button class="tab active" data-tab="practice">Üben</button>
      <button class="tab" data-tab="list">Liste</button>
    </div>

    <section class="card tab-panel" data-panel="practice">
      <h2>Vokabel hinzufügen</h2>
      <form id="addForm">
        <input id="word" placeholder="Wort (z. B. apple)" required />
        <input id="translation" placeholder="Übersetzung (z. B. Apfel)" required />
        <button type="submit">Hinzufügen</button>
      </form>
      <div class="controls">
        <label><input type="checkbox" id="reverseToggle" /> Umgekehrt (Deutsch → Original)</label>
        <button id="startPractice">Üben starten</button>
        <button id="export">Exportieren</button>
        <button id="importBtn">Importieren</button>
        <input id="importFile" type="file" accept="application/json" style="display:none" />
      </div>

      <div id="practiceCard" style="display:none">
        <h2>Übung</h2>
        <div id="cardWord" class="big"></div>
        <input id="answer" placeholder="Übersetzung eingeben" />
        <div class="practice-controls">
          <button id="check">Prüfen</button>
          <button id="next">Nächstes</button>
        </div>
        <div id="feedback" class="feedback"></div>
        <div id="stats" class="stats"></div>
      </div>
    </section>

    <section class="card tab-panel" data-panel="list" style="display:none">
      <h2>Vokabelliste</h2>
      <ul id="list" class="list"></ul>
    </section>
  </main>

  <div id="updateBanner" style="display:none;position:fixed;left:16px;right:16px;bottom:20px;background:linear-gradient(90deg,#fff,#f8fafc);border-radius:8px;padding:12px;box-shadow:0 6px 18px rgba(0,0,0,.08);align-items:center;justify-content:space-between;gap:12px;font-weight:500;z-index:9999">
    <div>Neue Version verfügbar — Seite neu laden?</div>
    <div>
      <button id="reloadBtn" style="background:#4F46E5;color:#fff;padding:8px 10px;border-radius:6px;border:none">Neu laden</button>
    </div>
  </div>

  <script src="app.js"></script>
  <script>
  if('serviceWorker' in navigator){
    function showUpdate() {
      const b = document.getElementById('updateBanner');
      if(!b) return;
      b.style.display = 'flex';
      const btn = document.getElementById('reloadBtn');
      btn.addEventListener('click', ()=>{
        navigator.serviceWorker.getRegistration().then(reg=>{
          if(reg && reg.waiting){
            reg.waiting.postMessage({type:'SKIP_WAITING'});
          } else {
            window.location.reload();
          }
        });
      }, {once:true});
    }

    navigator.serviceWorker.getRegistration().then(reg=>{
      if(!reg) return;
      if(reg.waiting) showUpdate();
      reg.addEventListener('updatefound', ()=>{
        const newWorker = reg.installing;
        if(newWorker){
          newWorker.addEventListener('statechange', ()=>{
            if(newWorker.state === 'installed' && navigator.serviceWorker.controller){
              showUpdate();
            }
          });
        }
      });
    }).catch(()=>{});

    navigator.serviceWorker.addEventListener('controllerchange', ()=>{
      window.location.reload();
    });
  }
  </script>

</body>
</html>
